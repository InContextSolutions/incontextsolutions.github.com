

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Getting Started &mdash; PandaSurvey 0.100 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="PandaSurvey 0.100 documentation" href="index.html"/>
        <link rel="next" title="PandaSurvey package" href="PandaSurvey.html"/>
        <link rel="prev" title="PandaSurvey" href="index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> PandaSurvey</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-usage">Basic Usage</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="PandaSurvey.html">PandaSurvey package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="PandaSurvey.html#subpackages">Subpackages</a></li>
<li class="toctree-l2"><a class="reference internal" href="PandaSurvey.html#module-PandaSurvey.base">PandaSurvey.base module</a></li>
</ul>
</li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">PandaSurvey</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Getting Started</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="sources/GettingStarted.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<div class="section" id="installation">
<h2>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="from-source">
<h3>From Source<a class="headerlink" href="#from-source" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre>git clone git@github.com:InContextSolutions/PandaSurvey.git
cd PandaSurvey
pip install .
</pre></div>
</div>
</div>
<div class="section" id="from-pypi">
<h3>From PyPI<a class="headerlink" href="#from-pypi" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre>pip install PandaSurvey
</pre></div>
</div>
</div>
</div>
<div class="section" id="basic-usage">
<h2>Basic Usage<a class="headerlink" href="#basic-usage" title="Permalink to this headline">¶</a></h2>
<p>The goal of this utility is to calculate respondent weights that allow one to transform a dataset into something more appropriate for inference. Two sample datasets are included for testing purposes. As of this version of PandaSurvey, only raking has been implemented.</p>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>We&#8217;ll rake the included <cite>People</cite> dataset to match a target demographic consisting of 80% female and 50% married respondents. First, we import the <cite>People</cite> dataset and view summary information.</p>
<div class="highlight-ipython"><div class="highlight"><pre>In [1]: from PandaSurvey import datasets

In [2]: df = datasets.load_people()

In [3]: df.head(5)
Out[3]:
   Age  Disability  MaritalStatus  Race  Gender
0   80           1              1     1       1
1   60           2              1     1       2
2   27           2              5     1       1
3   59           2              1     1       1
4   60           2              3     1       2

In [4]: df = df[[&#39;Gender&#39;, &#39;MaritalStatus&#39;]]

In [5]: df.head(5)
Out[5]:
    Gender  MaritalStatus
0        1              1
1        2              1
2        1              5
3        1              1
4        2              3

In [6]: import pandas

In [7]: pandas.crosstab(df.Gender, df.MaritalStatus)
Out[7]:
MaritalStatus     1    2    3   4     5
Gender
1              2159  125  388  62  2171
2              2090  411  499  99  1995
</pre></div>
</div>
<p>From above, the unweighted sample is about evenly split on gender and slightly more than 40% of the respondents are married (status equals one).</p>
<p>We only care about married and unmarried status, so we can aggregate responses above one together. We&#8217;re going to <cite>recode</cite> non-married responses to equal two. First, we create a SimpleRake object:</p>
<div class="highlight-ipython"><div class="highlight"><pre>In [8]: from PandaSurvey.rake.simple import SimpleRake

In [9]: rk = SimpleRake(df, {&#39;Gender&#39;: {1: 0.20, 2: 0.80}, &#39;MaritalStatus&#39;: {1: 0.50, 2: 0.50}})
</pre></div>
</div>
<p>Note the second parameter we gave SimpleRake. That dictionary defines the target demographic we want to get after applying weights. Now that we have a SimpleRake object, we can recode:</p>
<div class="highlight-ipython"><div class="highlight"><pre>In [10]: rk.recode({&#39;MaritalStatus&#39;: lambda x: 1 + 1*(x != 1)})

In [11]: pandas.crosstab(rk.df.Gender, rk.df.MaritalStatus)
Out[11]:
MaritalStatus     1     2
Gender
1              2159  2746
2              2090  3004
</pre></div>
</div>
<p>We&#8217;ve transformed our dataset and are ready to calculate weights.</p>
<div class="highlight-ipython"><div class="highlight"><pre>In [12]: wt_df = rk.calc()

In [13]: wt_df.head(5)
Out[13]:
   Gender  MaritalStatus    weight
0       1              1  0.485772
1       2              1  1.890296
2       1              2  0.346333
3       1              1  0.485772
4       2              2  1.347693
</pre></div>
</div>
<p>When <cite>calc</cite> is called, the raking procedure iteratively updates weights (starting from uniform weighting) until the marginal distributions match the target proportions.</p>
<p>So, how did we do?</p>
<div class="highlight-ipython"><div class="highlight"><pre>In [14]: wt_df[wt_df.Gender==2][&#39;weight&#39;].sum() / wt_df.weight.sum()
Out[14]: 0.79999901598236345

In [15]: wt_df[wt_df.MaritalStatus==1][&#39;weight&#39;].sum() / wt_df.weight.sum()
Out[15]: 0.50000000000002287

In [16]: rk.loss(wt_df.weight.values)
Out[16]: 0.37643439668734002
</pre></div>
</div>
<p>We can see that the gender and marital status proportions are nearly equal to the target (within a reasonable convergence tolerance).</p>
<p>The last statement (<cite>loss</cite>) approximates the increase in variance due to weighting. We can approximate the design effect by adding one to the loss (about 1.38, in this case).</p>
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="PandaSurvey.html" class="btn btn-neutral float-right" title="PandaSurvey package"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="PandaSurvey"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, InContext Solutions.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.100',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="static/jquery.js"></script>
      <script type="text/javascript" src="static/underscore.js"></script>
      <script type="text/javascript" src="static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>
